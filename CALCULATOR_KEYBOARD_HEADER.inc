#IFNDEF CALCULATOR_KEYBOARD_HEADER
#DEFINE CALCULATOR_KEYBOARD_HEADER
#INCLUDE"GENERAL_USE_HEADER.inc"
#INCLUDE"CALCULATOR_OPERATION_HEADER.inc"
    
    
K0	EQU	D'0' ;VALOR KEY 0
K1	EQU	D'1' ;VALOR KEY 1
K2	EQU	D'2' ;VALOR KEY 2
K3	EQU	D'3' ;VALOR KEY 3
K4	EQU	D'4' ;VALOR KEY 4
K5	EQU	D'5' ;VALOR KEY 5
K6	EQU	D'6' ;VALOR KEY 6
K7	EQU	D'7' ;VALOR KEY 7
K8	EQU	D'8' ;VALOR KEY 8
K9	EQU	D'9' ;VALOR KEY 9
 
;MACRO PARA HABILITAR A CONFIGURACAO DO TECLADO    
ENABLE_KEYBOARD MACRO 
 ;CONFIGURACAO DO TECLADO
 CONFIG_KEYBOARD:
    BANK1
    CLRF TRISB
    MOVLW B'00001111'
    MOVWF TRISD
    MOVLW B'00001111'
    MOVWF TRISA
    BANK0
    MOVLW B'00000000'
    MOVWF PORTB
    RETURN
 ENDM
    
;INPUT DO TECLADO
INPUT_KEYBOARD MACRO INPUT_VAL
 INPUT_LOOP:   
    BCF PORTB, RB0
    
    BTFSS TRISD, RD1
    GOTO MOV7        ; 7
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    
    BTFSS TRISD, RD2
    GOTO MOV4        ; 4
    CALL DELAY_1MS
    CALL DELAY_1MS

    
    BTFSS TRISD, RD3
    GOTO MOV1        ;1
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BSF PORTB, RB0
    
    BCF PORTB, RB1
    
    BTFSS TRISD, RD0
    GOTO MOV0        ;0
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BTFSS TRISD, RD1
    GOTO MOV8        ;8
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BTFSS TRISD, RD2
    GOTO MOV5        ;5
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BTFSS TRISD, RD3
    GOTO MOV2        ;2
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BSF PORTB, RB1
    
    BCF PORTB, RB2
    
    BTFSS TRISD, RD3
    GOTO MOV3        ;3
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BTFSS TRISD, RD2
    GOTO MOV6        ;6
    CALL DELAY_1MS
    CALL DELAY_1MS
    
    BTFSS TRISD, RD1
    GOTO MOV9        ;9
    CALL DELAY_1MS
    CALL DELAY_1MS
    BSF PORTB, RB2
    
    GOTO INPUT_LOOP
 
MOV0:
    MOVLW K0
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV1:
    MOVLW K1
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV2:
    MOVLW K2
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV3:
    MOVLW K3
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT    
MOV4:
    MOVLW K4
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV5:
    MOVLW K5
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV6:
    MOVLW K6
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT    
MOV7:
    MOVLW K7
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT
MOV8:
    MOVLW K8
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT    
MOV9:
    MOVLW K9
    MOVWF INPUT_VAL
    GOTO INPUT_EXIT 
    
INPUT_EXIT:
    CALL DELAY_255
    CALL DELAY_255
    RETURN
    
 ENDM   
    

 
 
 
 
    

#ENDIF